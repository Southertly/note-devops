# 关于SSL/TLS证书

参考文章

1. [openssl、x509、crt、cer、key、csr、ssl、tls 这些都是什么鬼?](https://www.cnblogs.com/lan1x/p/5872915.html)

除了https, 还有其他服务需要用到ssl证书, 如docker的harbor仓库, 各种消息队列mq的服务端口等, 它们都是运行在tcp协议之上的应用层协议. 

只不过https由于在浏览器中有界面显示, 看起来会直观一些. 另外浏览器默认保存了一个可信证书, 而对于一些服务器应用, 证书是由操作系统本身来管理的.

> HTTPS 加密是需要证书的, 而证书是很简单就可以生成的. 那么, 如果浏览器无条件信任所有证书, 黑客在监听网络或者进行中间人攻击时, 就可以通过伪造证书的方式, 使 HTTPS 形同虚设, 为了保证 HTTPS 的可靠, 就有了 CA（Certificate Authority, 证书颁发机构） 的概念, 并被广泛接受. 
> 
> 简单的说, 就是由少量的认证机构负责颁发证书, 认证机构负责核实对方的可信度, 操作系统和浏览器内会内置这些证书颁发机构的根证书, 如果经过检查网站使用的证书是可信任的 CA 颁发的, 就认为它是可信的, 反之就会给出不可信的提示, 提醒用户存在风险. 由于黑客很难获得可信 CA 颁发的证书, 所以这套体系保证了 HTTPS 最基本的可靠性. 

在购买证书的流程中, CA网站一般会要求用户自行生成私钥`key`文件, 以及`csr`证书签名请求文件, 并提交csr.

## 术语含义

- `*.key`: 通常指私钥.
- `*.csr`: `Certificate Signing Request`的缩写, 即证书签名请求, 这不是证书, 可以简单理解成公钥(但还包含了一些其他的信息), 生成证书时要把这个提交给权威的证书颁发机构.
- `*.crt`: 即`certificate`的缩写, 即证书.
- `x.509`: 是一种证书格式. 对`x.509`证书来说, 认证者总是CA或由CA指定的人, 一份`x.509`证书是一些标准字段的集合, 这些字段包含有关用户或设备及其相应公钥的信息.

`x.509`的证书文件, 一般以.crt结尾, 根据该文件的内容编码格式, 可以分为以下二种格式: 

1. `PEM` - Privacy Enhanced Mail, 打开看文本格式,以"-----BEGIN..."开头, "-----END..."结尾,内容是BASE64编码.
    - Apache和*NIX服务器偏向于使用这种编码格式.
2. `DER` - Distinguished Encoding Rules, 打开看是二进制格式,不可读.
    - Java和Windows服务器偏向于使用这种编码格式
